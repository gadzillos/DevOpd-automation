---
- name: Install java
  yum:
    name: java-11-openjdk-devel
    state: present
  vars:
    ansible_python_interpreter: /usr/bin/python

- name: Installing Git. Clone.
  ansible.builtin.shell: |
    yum -y install git
    git --version
    git clone -b pre_release https://gitlab.com/devops_netcraker/repo.git
       
- name: Download Long Term Jenkins release
  get_url:
    url: "{{ jenkins_url }}"
    dest: /etc/yum.repos.d/jenkins.repo

- name: Import jenkins key from url
  ansible.builtin.rpm_key:
    state: present
    key: {{ jenkins_key }}

- name: Install jenkins
  yum:
    name: jenkins
    state: present
  vars:
    ansible_python_interpreter: /usr/bin/python

- name: daemon-reload to pick up config changes
  ansible.builtin.systemd:
    daemon_reload: yes

- name: Start jenkins
  ansible.builtin.systemd:
    name: jenkins
    state: started